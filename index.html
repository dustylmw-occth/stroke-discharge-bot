  <script>
    window.addEventListener('dfMessengerLoaded', function () {
      const dfMessenger = document.querySelector('df-messenger');
      dfMessenger.open();
      // å¼·åˆ¶è¨­å®šæ¨™é¡Œ (æœ€å¾Œä¿éšª)
      setTimeout(() => {
        try {
          const titleEl = dfMessenger.shadowRoot.querySelector('.df-messenger-titlebar-title');
          if (titleEl) titleEl.textContent = 'è·æ¥­æ²»ç™‚æ™ºèƒ½æ”¯æ´åŠ©ç†';
        } catch(e) {}
      }, 800);

      // ==================== è‡ªå‹•èªžéŸ³æœ—è®€ (Auto TTS) ====================
      let ttsEnabled = true;   // é è¨­é–‹å•Ÿ

      const speak = (text) => {
        if (!ttsEnabled || !('speechSynthesis' in window)) return;
        speechSynthesis.cancel(); // åœæ­¢ä¹‹å‰çš„èªžéŸ³
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'zh-HK';        // å»£æ±è©±
        utterance.rate = 0.92;           // æ…¢ä¸€é»žï¼Œé•·è€…æ›´å®¹æ˜“è½
        utterance.pitch = 1.0;
        speechSynthesis.speak(utterance);
      };

      // ç›£è½æ©Ÿæ¢°äººæ–°è¨Šæ¯ï¼ˆå…¼å®¹ df-messenger shadow DOMï¼‰
      setTimeout(() => {
        try {
          const chatRoot = dfMessenger.shadowRoot.querySelector('df-messenger-chat').shadowRoot;
          const observer = new MutationObserver((mutations) => {
            mutations.forEach((mutation) => {
              mutation.addedNodes.forEach((node) => {
                if (node.nodeType === 1) {
                  const text = node.textContent.trim();
                  if (text.length > 15) {   // åªæœ—è®€æœ‰æ„ç¾©çš„é•·è¨Šæ¯
                    speak(text);
                  }
                }
              });
            });
          });
          observer.observe(chatRoot, { childList: true, subtree: true });
        } catch(e) {}
      }, 1500);

      // å³ä¸‹è§’èªžéŸ³é–‹é—œæŒ‰éˆ•ï¼ˆé©åˆæ‰‹æ©Ÿï¼‰
      const toggleBtn = document.createElement('button');
      toggleBtn.innerHTML = 'ðŸ”Š èªžéŸ³æœ—è®€';
      toggleBtn.style.position = 'fixed';
      toggleBtn.style.bottom = '95px';
      toggleBtn.style.right = '20px';
      toggleBtn.style.zIndex = '10000';
      toggleBtn.style.padding = '10px 18px';
      toggleBtn.style.borderRadius = '30px';
      toggleBtn.style.border = 'none';
      toggleBtn.style.background = '#3b82f6';
      toggleBtn.style.color = 'white';
      toggleBtn.style.fontSize = '15px';
      toggleBtn.style.boxShadow = '0 2px 8px rgba(0,0,0,0.2)';
      toggleBtn.onclick = () => {
        ttsEnabled = !ttsEnabled;
        toggleBtn.innerHTML = ttsEnabled ? 'ðŸ”Š èªžéŸ³æœ—è®€' : 'ðŸ”‡ èªžéŸ³é—œé–‰';
        toggleBtn.style.background = ttsEnabled ? '#3b82f6' : '#64748b';
      };
      document.body.appendChild(toggleBtn);
    });
  </script>
